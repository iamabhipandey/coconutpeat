import { Component, EventEmitter, Input, Output, ViewChild, } from '@angular/core';
import { NgxImageZoomService } from './ngx-image-zoom.service';
import { ClickZoomMode } from './zoom-modes/click-zoom-mode';
import { HoverFreezeZoomMode } from './zoom-modes/hover-freeze-zoom-mode';
import { HoverZoomMode } from './zoom-modes/hover-zoom-mode';
import { ToggleClickZoomMode } from './zoom-modes/toggle-click-zoom-mode';
import { ToggleFreezeZoomMode } from './zoom-modes/toggle-freeze-zoom-mode';
import { ToggleZoomMode } from './zoom-modes/toggle-zoom-mode';
import * as i0 from "@angular/core";
import * as i1 from "./ngx-image-zoom.service";
import * as i2 from "@angular/common";
export class NgxImageZoomComponent {
    constructor(zoomService, renderer) {
        this.zoomService = zoomService;
        this.renderer = renderer;
        this.zoomScroll = new EventEmitter();
        this.zoomPosition = new EventEmitter();
        this.imagesLoaded = new EventEmitter();
        this.lensBorderRadius = 0;
        this.zoomMode = 'hover';
        this.enableScrollZoom = false;
        this.scrollStepSize = 0.1;
        this.circularLens = false;
        this.thumbImageLoaded = false;
        this.subscriptions = [];
        this.eventListeners = [];
        this.zoomModesMap = new Map([
            ['click', ClickZoomMode],
            ['hover-freeze', HoverFreezeZoomMode],
            ['hover', HoverZoomMode],
            ['toggle-click', ToggleClickZoomMode],
            ['toggle-freeze', ToggleFreezeZoomMode],
            ['toggle', ToggleZoomMode],
        ]);
        this.altText = '';
        this.titleText = '';
    }
    set setThumbImage(thumbImage) {
        this.thumbImageLoaded = false;
        this.setIsReady(false);
        this.thumbImage = thumbImage;
    }
    set setFullImage(fullImage) {
        this.zoomService.fullImageLoaded = false;
        this.setIsReady(false);
        this.fullImage = fullImage;
    }
    set setZoomMode(zoomMode) {
        if (NgxImageZoomComponent.validZoomModes.some((m) => m === zoomMode)) {
            this.zoomMode = zoomMode;
        }
    }
    set setMagnification(magnification) {
        this.zoomService.magnification = Number(magnification) || this.zoomService.magnification;
        this.zoomScroll.emit(this.zoomService.magnification);
    }
    set setMinZoomRatio(minZoomRatio) {
        const ratio = Number(minZoomRatio) || this.zoomService.minZoomRatio || this.zoomService.baseRatio || 0;
        this.zoomService.minZoomRatio = Math.max(ratio, this.zoomService.baseRatio || 0);
    }
    set setMaxZoomRatio(maxZoomRatio) {
        this.zoomService.maxZoomRatio = Number(maxZoomRatio) || this.zoomService.maxZoomRatio;
    }
    set setScrollStepSize(stepSize) {
        this.scrollStepSize = Number(stepSize) || this.scrollStepSize;
    }
    set setEnableLens(enable) {
        this.zoomService.enableLens = Boolean(enable);
    }
    set setLensWidth(width) {
        this.zoomService.lensWidth = Number(width) || this.zoomService.lensWidth;
    }
    set setLensHeight(height) {
        this.zoomService.lensHeight = Number(height) || this.zoomService.lensHeight;
    }
    set setCircularLens(enable) {
        this.circularLens = Boolean(enable);
    }
    set setEnableScrollZoom(enable) {
        this.enableScrollZoom = Boolean(enable);
    }
    ngOnInit() {
        // If no full size image is defined, we add the thumbnail as the full size too.
        if (this.fullImage === undefined) {
            this.fullImage = this.thumbImage;
        }
        this.registerServiceSubscriptions();
        // Load zoom mode and set up configuration.
        this.loadZoomMode();
        this.registerEventListeners();
        this.calculateLensBorder();
    }
    ngOnChanges() {
        this.calculateLensBorder();
        this.zoomService.calculateRatioAndOffset();
        this.zoomService.calculateImageAndLensPosition();
    }
    ngOnDestroy() {
        this.subscriptions.forEach((subscription) => subscription.unsubscribe());
        this.eventListeners.forEach((destroyFn) => destroyFn());
    }
    registerServiceSubscriptions() {
        this.subscriptions.push(this.zoomService.zoomPosition.subscribe((position) => this.zoomPosition.emit(position)));
    }
    loadZoomMode() {
        const ZoomModeClass = this.zoomModesMap.get(this.zoomMode);
        if (ZoomModeClass) {
            this.zoomInstance = new ZoomModeClass(this.zoomService);
        }
        else {
            console.error(`Unsupported zoom mode: ${this.zoomMode}`);
        }
    }
    registerEventListeners() {
        if (this.zoomInstance) {
            const nativeElement = this.zoomContainer.nativeElement;
            this.eventListeners.push(this.renderer.listen(nativeElement, 'mouseenter', (event) => this.zoomInstance.onMouseEnter(event)), this.renderer.listen(nativeElement, 'mouseleave', (event) => this.zoomInstance.onMouseLeave(event)), this.renderer.listen(nativeElement, 'mousemove', (event) => this.zoomInstance.onMouseMove(event)), this.renderer.listen(nativeElement, 'click', (event) => this.zoomInstance.onClick(event)), 
            // Chrome: 'mousewheel', Firefox: 'DOMMouseScroll', IE: 'onmousewheel'
            this.renderer.listen(nativeElement, 'mousewheel', (event) => {
                if (this.zoomInstance.onMouseWheel(event)) {
                    this.onMouseWheel(event);
                }
            }), this.renderer.listen(nativeElement, 'DOMMouseScroll', (event) => {
                if (this.zoomInstance.onMouseWheel(event)) {
                    this.onMouseWheel(event);
                }
            }), this.renderer.listen(nativeElement, 'onmousewheel', (event) => {
                if (this.zoomInstance.onMouseWheel(event)) {
                    this.onMouseWheel(event);
                }
            }));
        }
    }
    /**
     * Template helper methods
     */
    onThumbImageLoaded() {
        // Pass along image sizes to the service.
        this.zoomService.thumbWidth = this.imageThumbnail.nativeElement.width;
        this.zoomService.thumbHeight = this.imageThumbnail.nativeElement.height;
        this.thumbImageLoaded = true;
        this.checkImagesLoaded();
    }
    onFullImageLoaded() {
        // Pass along image sizes to the service.
        this.zoomService.fullWidth = this.fullSizeImage.nativeElement.naturalWidth;
        this.zoomService.fullHeight = this.fullSizeImage.nativeElement.naturalHeight;
        this.zoomService.fullImageLoaded = true;
        this.checkImagesLoaded();
    }
    calculateLensBorder() {
        if (this.zoomService.enableLens) {
            if (this.circularLens) {
                this.lensBorderRadius = this.zoomService.lensWidth / 2;
            }
            else {
                this.lensBorderRadius = 0;
            }
        }
    }
    checkImagesLoaded() {
        this.zoomService.calculateRatioAndOffset();
        if (this.thumbImageLoaded && this.zoomService.fullImageLoaded) {
            this.zoomService.calculateImageAndLensPosition();
            this.setIsReady(true);
        }
    }
    setIsReady(value) {
        this.zoomService.isReady = value;
        this.imagesLoaded.emit(value);
    }
    /**
     * Mouse wheel event
     */
    // eslint-disable-next-line @typescript-eslint/no-explicit-any
    onMouseWheel(event) {
        // Don't eat events if scrollZoom or zooming isn't active
        if (!this.enableScrollZoom || !this.zoomService.zoomingEnabled) {
            return;
        }
        event = window.event || event; // old IE
        const direction = Math.max(Math.min(event.wheelDelta || -event.detail, 1), -1);
        if (direction > 0) {
            // up
            this.setMagnification = Math.min(this.zoomService.magnification + this.scrollStepSize, this.zoomService.maxZoomRatio);
        }
        else {
            // down
            this.setMagnification = Math.max(this.zoomService.magnification - this.scrollStepSize, this.zoomService.minZoomRatio);
        }
        this.zoomService.calculateRatio();
        this.zoomService.calculateZoomPosition(event);
        // Prevent scrolling on page.
        event.returnValue = false; // IE
        if (event.preventDefault) {
            event.preventDefault(); // Chrome & FF
        }
    }
}
NgxImageZoomComponent.validZoomModes = [
    'hover',
    'toggle',
    'click',
    'toggle-click',
    'toggle-freeze',
    'hover-freeze',
];
NgxImageZoomComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.1.3", ngImport: i0, type: NgxImageZoomComponent, deps: [{ token: i1.NgxImageZoomService }, { token: i0.Renderer2 }], target: i0.ɵɵFactoryTarget.Component });
NgxImageZoomComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.1.3", type: NgxImageZoomComponent, selector: "lib-ngx-image-zoom", inputs: { setThumbImage: ["thumbImage", "setThumbImage"], setFullImage: ["fullImage", "setFullImage"], setZoomMode: ["zoomMode", "setZoomMode"], setMagnification: ["magnification", "setMagnification"], setMinZoomRatio: ["minZoomRatio", "setMinZoomRatio"], setMaxZoomRatio: ["maxZoomRatio", "setMaxZoomRatio"], setScrollStepSize: ["scrollStepSize", "setScrollStepSize"], setEnableLens: ["enableLens", "setEnableLens"], setLensWidth: ["lensWidth", "setLensWidth"], setLensHeight: ["lensHeight", "setLensHeight"], setCircularLens: ["circularLens", "setCircularLens"], setEnableScrollZoom: ["enableScrollZoom", "setEnableScrollZoom"], altText: "altText", titleText: "titleText" }, outputs: { zoomScroll: "zoomScroll", zoomPosition: "zoomPosition", imagesLoaded: "imagesLoaded" }, providers: [NgxImageZoomService], viewQueries: [{ propertyName: "zoomContainer", first: true, predicate: ["zoomContainer"], descendants: true, static: true }, { propertyName: "imageThumbnail", first: true, predicate: ["imageThumbnail"], descendants: true, static: true }, { propertyName: "fullSizeImage", first: true, predicate: ["fullSizeImage"], descendants: true, static: true }], usesOnChanges: true, ngImport: i0, template: "<div\n    #zoomContainer\n    class=\"ngxImageZoomContainer\"\n    [style.width.px]=\"this.zoomService.thumbWidth\"\n    [style.height.px]=\"this.zoomService.thumbHeight\"\n>\n    <img\n        #imageThumbnail\n        class=\"ngxImageZoomThumbnail\"\n        [alt]=\"altText\"\n        [title]=\"titleText\"\n        [src]=\"thumbImage\"\n        (load)=\"onThumbImageLoaded()\"\n    />\n\n    <div\n        [ngClass]=\"{\n            ngxImageZoomFullContainer: true,\n            ngxImageZoomLensEnabled: this.zoomService.enableLens\n        }\"\n        [style.display]=\"this.zoomService.zoomDisplay\"\n        [style.top.px]=\"this.zoomService.lensTop\"\n        [style.left.px]=\"this.zoomService.lensLeft\"\n        [style.width.px]=\"this.zoomService.lensWidth\"\n        [style.height.px]=\"this.zoomService.lensHeight\"\n        [style.border-radius.px]=\"this.lensBorderRadius\"\n    >\n        <img\n            #fullSizeImage\n            class=\"ngxImageZoomFull\"\n            [alt]=\"altText\"\n            [title]=\"titleText\"\n            [src]=\"fullImage\"\n            (load)=\"onFullImageLoaded()\"\n            [style.display]=\"this.zoomService.zoomDisplay\"\n            [style.top.px]=\"this.zoomService.fullImageTop\"\n            [style.left.px]=\"this.zoomService.fullImageLeft\"\n            [style.width.px]=\"this.zoomService.magnifiedWidth\"\n            [style.height.px]=\"this.zoomService.magnifiedHeight\"\n        />\n    </div>\n</div>\n", styles: [".ngxImageZoomContainer{position:relative;margin:auto;overflow:hidden;pointer-events:none}.ngxImageZoomThumbnail{pointer-events:all}.ngxImageZoomFull{position:absolute;max-width:none;max-height:none;display:none;pointer-events:none}.ngxImageZoomFullContainer{position:absolute;overflow:hidden;pointer-events:none}.ngxImageZoomFullContainer.ngxImageZoomLensEnabled{border:2px solid red;cursor:crosshair;pointer-events:none}\n"], dependencies: [{ kind: "directive", type: i2.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.1.3", ngImport: i0, type: NgxImageZoomComponent, decorators: [{
            type: Component,
            args: [{ selector: 'lib-ngx-image-zoom', providers: [NgxImageZoomService], template: "<div\n    #zoomContainer\n    class=\"ngxImageZoomContainer\"\n    [style.width.px]=\"this.zoomService.thumbWidth\"\n    [style.height.px]=\"this.zoomService.thumbHeight\"\n>\n    <img\n        #imageThumbnail\n        class=\"ngxImageZoomThumbnail\"\n        [alt]=\"altText\"\n        [title]=\"titleText\"\n        [src]=\"thumbImage\"\n        (load)=\"onThumbImageLoaded()\"\n    />\n\n    <div\n        [ngClass]=\"{\n            ngxImageZoomFullContainer: true,\n            ngxImageZoomLensEnabled: this.zoomService.enableLens\n        }\"\n        [style.display]=\"this.zoomService.zoomDisplay\"\n        [style.top.px]=\"this.zoomService.lensTop\"\n        [style.left.px]=\"this.zoomService.lensLeft\"\n        [style.width.px]=\"this.zoomService.lensWidth\"\n        [style.height.px]=\"this.zoomService.lensHeight\"\n        [style.border-radius.px]=\"this.lensBorderRadius\"\n    >\n        <img\n            #fullSizeImage\n            class=\"ngxImageZoomFull\"\n            [alt]=\"altText\"\n            [title]=\"titleText\"\n            [src]=\"fullImage\"\n            (load)=\"onFullImageLoaded()\"\n            [style.display]=\"this.zoomService.zoomDisplay\"\n            [style.top.px]=\"this.zoomService.fullImageTop\"\n            [style.left.px]=\"this.zoomService.fullImageLeft\"\n            [style.width.px]=\"this.zoomService.magnifiedWidth\"\n            [style.height.px]=\"this.zoomService.magnifiedHeight\"\n        />\n    </div>\n</div>\n", styles: [".ngxImageZoomContainer{position:relative;margin:auto;overflow:hidden;pointer-events:none}.ngxImageZoomThumbnail{pointer-events:all}.ngxImageZoomFull{position:absolute;max-width:none;max-height:none;display:none;pointer-events:none}.ngxImageZoomFullContainer{position:absolute;overflow:hidden;pointer-events:none}.ngxImageZoomFullContainer.ngxImageZoomLensEnabled{border:2px solid red;cursor:crosshair;pointer-events:none}\n"] }]
        }], ctorParameters: function () { return [{ type: i1.NgxImageZoomService }, { type: i0.Renderer2 }]; }, propDecorators: { zoomContainer: [{
                type: ViewChild,
                args: ['zoomContainer', { static: true }]
            }], imageThumbnail: [{
                type: ViewChild,
                args: ['imageThumbnail', { static: true }]
            }], fullSizeImage: [{
                type: ViewChild,
                args: ['fullSizeImage', { static: true }]
            }], zoomScroll: [{
                type: Output
            }], zoomPosition: [{
                type: Output
            }], imagesLoaded: [{
                type: Output
            }], setThumbImage: [{
                type: Input,
                args: ['thumbImage']
            }], setFullImage: [{
                type: Input,
                args: ['fullImage']
            }], setZoomMode: [{
                type: Input,
                args: ['zoomMode']
            }], setMagnification: [{
                type: Input,
                args: ['magnification']
            }], setMinZoomRatio: [{
                type: Input,
                args: ['minZoomRatio']
            }], setMaxZoomRatio: [{
                type: Input,
                args: ['maxZoomRatio']
            }], setScrollStepSize: [{
                type: Input,
                args: ['scrollStepSize']
            }], setEnableLens: [{
                type: Input,
                args: ['enableLens']
            }], setLensWidth: [{
                type: Input,
                args: ['lensWidth']
            }], setLensHeight: [{
                type: Input,
                args: ['lensHeight']
            }], setCircularLens: [{
                type: Input,
                args: ['circularLens']
            }], setEnableScrollZoom: [{
                type: Input,
                args: ['enableScrollZoom']
            }], altText: [{
                type: Input
            }], titleText: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWltYWdlLXpvb20uY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2xpYi9uZ3gtaW1hZ2Utem9vbS5jb21wb25lbnQudHMiLCIuLi8uLi8uLi9zcmMvbGliL25neC1pbWFnZS16b29tLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFDSCxTQUFTLEVBRVQsWUFBWSxFQUNaLEtBQUssRUFJTCxNQUFNLEVBRU4sU0FBUyxHQUNaLE1BQU0sZUFBZSxDQUFDO0FBR3ZCLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQy9ELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSw4QkFBOEIsQ0FBQztBQUM3RCxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxxQ0FBcUMsQ0FBQztBQUMxRSxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFDN0QsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0scUNBQXFDLENBQUM7QUFDMUUsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sc0NBQXNDLENBQUM7QUFDNUUsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLCtCQUErQixDQUFDOzs7O0FBYy9ELE1BQU0sT0FBTyxxQkFBcUI7SUEwQzlCLFlBQW1CLFdBQWdDLEVBQVUsUUFBbUI7UUFBN0QsZ0JBQVcsR0FBWCxXQUFXLENBQXFCO1FBQVUsYUFBUSxHQUFSLFFBQVEsQ0FBVztRQTVCdEUsZUFBVSxHQUFHLElBQUksWUFBWSxFQUFVLENBQUM7UUFDeEMsaUJBQVksR0FBRyxJQUFJLFlBQVksRUFBUyxDQUFDO1FBQ3pDLGlCQUFZLEdBQUcsSUFBSSxZQUFZLEVBQVcsQ0FBQztRQUk5QyxxQkFBZ0IsR0FBRyxDQUFDLENBQUM7UUFFcEIsYUFBUSxHQUFHLE9BQU8sQ0FBQztRQUNuQixxQkFBZ0IsR0FBRyxLQUFLLENBQUM7UUFDekIsbUJBQWMs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WixhQUFhO3NCQUR2QixLQUFLO3VCQUFDLFlBQVk7Z0JBTVIsWUFBWTtzQkFEdEIsS0FBSzt1QkFBQyxXQUFXO2dCQU1QLGFBQWE7c0JBRHZCLEtBQUs7dUJBQUMsWUFBWTtnQkFNUixlQUFlO3NCQUR6QixLQUFLO3VCQUFDLGNBQWM7Z0JBTVYsbUJBQW1CO3NCQUQ3QixLQUFLO3VCQUFDLGtCQUFrQjtnQkFLaEIsT0FBTztzQkFBZixLQUFLO2dCQUNHLFNBQVM7c0JBQWpCLEtBQUsiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICAgIENvbXBvbmVudCxcbiAgICBFbGVtZW50UmVmLFxuICAgIEV2ZW50RW1pdHRlcixcbiAgICBJbnB1dCxcbiAgICBPbkNoYW5nZXMsXG4gICAgT25EZXN0cm95LFxuICAgIE9uSW5pdCxcbiAgICBPdXRwdXQsXG4gICAgUmVuZGVyZXIyLFxuICAgIFZpZXdDaGlsZCxcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBTYWZlVXJsIH0gZnJvbSAnQGFuZ3VsYXIvcGxhdGZvcm0tYnJvd3Nlcic7XG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IE5neEltYWdlWm9vbVNlcnZpY2UgfSBmcm9tICcuL25neC1pbWFnZS16b29tLnNlcnZpY2UnO1xuaW1wb3J0IHsgQ2xpY2tab29tTW9kZSB9IGZyb20gJy4vem9vbS1tb2Rlcy9jbGljay16b29tLW1vZGUnO1xuaW1wb3J0IHsgSG92ZXJGcmVlemVab29tTW9kZSB9IGZyb20gJy4vem9vbS1tb2Rlcy9ob3Zlci1mcmVlemUtem9vbS1tb2RlJztcbmltcG9ydCB7IEhvdmVyWm9vbU1vZGUgfSBmcm9tICcuL3pvb20tbW9kZXMvaG92ZXItem9vbS1tb2RlJztcbmltcG9ydCB7IFRvZ2dsZUNsaWNrWm9vbU1vZGUgfSBmcm9tICcuL3pvb20tbW9kZXMvdG9nZ2xlLWNsaWNrLXpvb20tbW9kZSc7XG5pbXBvcnQgeyBUb2dnbGVGcmVlemVab29tTW9kZSB9IGZyb20gJy4vem9vbS1tb2Rlcy90b2dnbGUtZnJlZXplLXpvb20tbW9kZSc7XG5pbXBvcnQgeyBUb2dnbGVab29tTW9kZSB9IGZyb20gJy4vem9vbS1tb2Rlcy90b2dnbGUtem9vbS1tb2RlJztcbmltcG9ydCB7IFpvb21Nb2RlIH0gZnJvbSAnLi96b29tLW1vZGVzL3pvb20tbW9kZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29vcmQge1xuICAgIHg6IG51bWJlcjtcbiAgICB5OiBudW1iZXI7XG59XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAnbGliLW5neC1pbWFnZS16b29tJyxcbiAgICB0ZW1wbGF0ZVVybDogJy4vbmd4LWltYWdlLXpvb20uY29tcG9uZW50Lmh0bWwnLFxuICAgIHN0eWxlVXJsczogWycuL25neC1pbWFnZS16b29tLmNvbXBvbmVudC5jc3MnXSxcbiAgICBwcm92aWRlcnM6IFtOZ3hJbWFnZVpvb21TZXJ2aWNlXSxcbn0pXG5leHBvcnQgY2xhc3MgTmd4SW1hZ2Vab29tQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMsIE9uRGVzdHJveSB7XG4gICAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgdmFsaWRab29tTW9kZXM6IHN0cmluZ1tdID0gW1xuICAgICAgICAnaG92ZXInLFxuICAgICAgICAndG9nZ2xlJyxcbiAgICAgICAgJ2NsaWNrJyxcbiAgICAgICAgJ3RvZ2dsZS1jbGljaycsXG4gICAgICAgICd0b2dnbGUtZnJlZXplJyxcbiAgICAgICAgJ2hvdmVyLWZyZWV6ZScsXG4gICAgXTtcblxuICAgIEBWaWV3Q2hpbGQoJ3pvb21Db250YWluZXInLCB7IHN0YXRpYzogdHJ1ZSB9KSB6b29tQ29udGFpbmVyITogRWxlbWVudFJlZjtcbiAgICBAVmlld0NoaWxkKCdpbWFnZVRodW1ibmFpbCcsIHsgc3RhdGljOiB0cnVlIH0pIGltYWdlVGh1bWJuYWlsITogRWxlbWVudFJlZjtcbiAgICBAVmlld0NoaWxkKCdmdWxsU2l6ZUltYWdlJywgeyBzdGF0aWM6IHRydWUgfSkgZnVsbFNpemVJbWFnZSE6IEVsZW1lbnRSZWY7XG5cbiAgICBAT3V0cHV0KCkgem9vbVNjcm9sbCA9IG5ldyBFdmVudEVtaXR0ZXI8bnVtYmVyPigpO1xuICAgIEBPdXRwdXQoKSB6b29tUG9zaXRpb24gPSBuZXcgRXZlbnRFbWl0dGVyPENvb3JkPigpO1xuICAgIEBPdXRwdXQoKSBpbWFnZXNMb2FkZWQgPSBuZXcgRXZlbnRFbWl0dGVyPGJvb2xlYW4+KCk7XG5cbiAgICBwdWJsaWMgdGh1bWJJbWFnZT86IHN0cmluZyB8IFNhZmVVcmwgfCBudWxsO1xuICAgIHB1YmxpYyBmdWxsSW1hZ2U/OiBzdHJpbmcgfCBTYWZlVXJsIHwgbnVsbDtcbiAgICBwdWJsaWMgbGVuc0JvcmRlclJhZGl1cyA9IDA7XG5cbiAgICBwcml2YXRlIHpvb21Nb2RlID0gJ2hvdmVyJztcbiAgICBwcml2YXRlIGVuYWJsZVNjcm9sbFpvb20gPSBmYWxzZTtcbiAgICBwcml2YXRlIHNjcm9sbFN0ZXBTaXplID0gMC4xO1xuICAgIHByaXZhdGUgY2lyY3VsYXJMZW5zID0gZmFsc2U7XG5cbiAgICBwcml2YXRlIHRodW1iSW1hZ2VMb2FkZWQgPSBmYWxzZTtcblxuICAgIHByaXZhdGUgem9vbUluc3RhbmNlOiBab29tTW9kZSB8IHVuZGVmaW5lZDtcbiAgICBwcml2YXRlIHN1YnNjcmlwdGlvbnM6IEFycmF5PFN1YnNjcmlwdGlvbj4gPSBbXTtcbiAgICBwcml2YXRlIGV2ZW50TGlzdGVuZXJzOiAoKCkgPT4gdm9pZClbXSA9IFtdO1xuXG4gICAgcHJpdmF0ZSB6b29tTW9kZXNNYXAgPSBuZXcgTWFwPHN0cmluZywgbmV3ICh6b29tU2VydmljZTogTmd4SW1hZ2Vab29tU2VydmljZSkgPT4gWm9vbU1vZGU+KFtcbiAgICAgICAgWydjbGljaycsIENsaWNrWm9vbU1vZGVdLFxuICAgICAgICBbJ2hvdmVyLWZyZWV6ZScsIEhvdmVyRnJlZXplWm9vbU1vZGVdLFxuICAgICAgICBbJ2hvdmVyJywgSG92ZXJab29tTW9kZV0sXG4gICAgICAgIFsndG9nZ2xlLWNsaWNrJywgVG9nZ2xlQ2xpY2tab29tTW9kZV0sXG4gICAgICAgIFsndG9nZ2xlLWZyZWV6ZScsIFRvZ2dsZUZyZWV6ZVpvb21Nb2RlXSxcbiAgICAgICAgWyd0b2dnbGUnLCBUb2dnbGVab29tTW9kZV0sXG4gICAgXSk7XG5cbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgem9vbVNlcnZpY2U6IE5neEltYWdlWm9vbVNlcnZpY2UsIHByaXZhdGUgcmVuZGVyZXI6IFJlbmRlcmVyMikge31cblxuICAgIEBJbnB1dCgndGh1bWJJbWFnZScpXG4gICAgcHVibGljIHNldCBzZXRUaHVtYkltYWdlKHRodW1iSW1hZ2U6IHN0cmluZyB8IFNhZmVVcmwgfCBudWxsKSB7XG4gICAgICAgIHRoaXMudGh1bWJJbWFnZUxvYWRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnNldElzUmVhZHkoZmFsc2UpO1xuICAgICAgICB0aGlzLnRodW1iSW1hZ2UgPSB0aHVtYkltYWdlO1xuICAgIH1cblxuICAgIEBJbnB1dCgnZnVsbEltYWdlJylcbiAgICBwdWJsaWMgc2V0IHNldEZ1bGxJbWFnZShmdWxsSW1hZ2U6IHN0cmluZyB8IFNhZmVVcmwgfCBudWxsKSB7XG4gICAgICAgIHRoaXMuem9vbVNlcnZpY2UuZnVsbEltYWdlTG9hZGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc2V0SXNSZWFkeShmYWxzZSk7XG4gICAgICAgIHRoaXMuZnVsbEltYWdlID0gZnVsbEltYWdlO1xuICAgIH1cblxuICAgIEBJbnB1dCgnem9vbU1vZGUnKVxuICAgIHB1YmxpYyBzZXQgc2V0Wm9vbU1vZGUoem9vbU1vZGU6IHN0cmluZykge1xuICAgICAgICBpZiAoTmd4SW1hZ2Vab29tQ29tcG9uZW50LnZhbGlkWm9vbU1vZGVzLnNvbWUoKG0pID0+IG0gPT09IHpvb21Nb2RlKSkge1xuICAgICAgICAgICAgdGhpcy56b29tTW9kZSA9IHpvb21Nb2RlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgQElucHV0KCdtYWduaWZpY2F0aW9uJylcbiAgICBwdWJsaWMgc2V0IHNldE1hZ25pZmljYXRpb24obWFnbmlmaWNhdGlvbjogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMuem9vbVNlcnZpY2UubWFnbmlmaWNhdGlvbiA9IE51bWJlcihtYWduaWZpY2F0aW9uKSB8fCB0aGlzLnpvb21TZXJ2aWNlLm1hZ25pZmljYXRpb247XG4gICAgICAgIHRoaXMuem9vbVNjcm9sbC5lbWl0KHRoaXMuem9vbVNlcnZpY2UubWFnbmlmaWNhdGlvbik7XG4gICAgfVxuXG4gICAgQElucHV0KCdtaW5ab29tUmF0aW8nKVxuICAgIHB1YmxpYyBzZXQgc2V0TWluWm9vbVJhdGlvKG1pblpvb21SYXRpbzogbnVtYmVyKSB7XG4gICAgICAgIGNvbnN0IHJhdGlvID0gTnVtYmVyKG1pblpvb21SYXRpbykgfHwgdGhpcy56b29tU2VydmljZS5taW5ab29tUmF0aW8gfHwgdGhpcy56b29tU2VydmljZS5iYXNlUmF0aW8gfHwgMDtcbiAgICAgICAgdGhpcy56b29tU2VydmljZS5taW5ab29tUmF0aW8gPSBNYXRoLm1heChyYXRpbywgdGhpcy56b29tU2VydmljZS5iYXNlUmF0aW8gfHwgMCk7XG4gICAgfVxuXG4gICAgQElucHV0KCdtYXhab29tUmF0aW8nKVxuICAgIHB1YmxpYyBzZXQgc2V0TWF4Wm9vbVJhdGlvKG1heFpvb21SYXRpbzogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMuem9vbVNlcnZpY2UubWF4Wm9vbVJhdGlvID0gTnVtYmVyKG1heFpvb21SYXRpbykgfHwgdGhpcy56b29tU2VydmljZS5tYXhab29tUmF0aW87XG4gICAgfVxuXG4gICAgQElucHV0KCdzY3JvbGxTdGVwU2l6ZScpXG4gICAgcHVibGljIHNldCBzZXRTY3JvbGxTdGVwU2l6ZShzdGVwU2l6ZTogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMuc2Nyb2xsU3RlcFNpemUgPSBOdW1iZXIoc3RlcFNpemUpIHx8IHRoaXMuc2Nyb2xsU3RlcFNpemU7XG4gICAgfVxuXG4gICAgQElucHV0KCdlbmFibGVMZW5zJylcbiAgICBwdWJsaWMgc2V0IHNldEVuYWJsZUxlbnMoZW5hYmxlOiBib29sZWFuKSB7XG4gICAgICAgIHRoaXMuem9vbVNlcnZpY2UuZW5hYmxlTGVucyA9IEJvb2xlYW4oZW5hYmxlKTtcbiAgICB9XG5cbiAgICBASW5wdXQoJ2xlbnNXaWR0aCcpXG4gICAgcHVibGljIHNldCBzZXRMZW5zV2lkdGgod2lkdGg6IG51bWJlcikge1xuICAgICAgICB0aGlzLnpvb21TZXJ2aWNlLmxlbnNXaWR0aCA9IE51bWJlcih3aWR0aCkgfHwgdGhpcy56b29tU2VydmljZS5sZW5zV2lkdGg7XG4gICAgfVxuXG4gICAgQElucHV0KCdsZW5zSGVpZ2h0JylcbiAgICBwdWJsaWMgc2V0IHNldExlbnNIZWlnaHQoaGVpZ2h0OiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy56b29tU2VydmljZS5sZW5zSGVpZ2h0ID0gTnVtYmVyKGhlaWdodCkgfHwgdGhpcy56b29tU2VydmljZS5sZW5zSGVpZ2h0O1xuICAgIH1cblxuICAgIEBJbnB1dCgnY2lyY3VsYXJMZW5zJylcbiAgICBwdWJsaWMgc2V0IHNldENpcmN1bGFyTGVucyhlbmFibGU6IGJvb2xlYW4pIHtcbiAgICAgICAgdGhpcy5jaXJjdWxhckxlbnMgPSBCb29sZWFuKGVuYWJsZSk7XG4gICAgfVxuXG4gICAgQElucHV0KCdlbmFibGVTY3JvbGxab29tJylcbiAgICBwdWJsaWMgc2V0IHNldEVuYWJsZVNjcm9sbFpvb20oZW5hYmxlOiBib29sZWFuKSB7XG4gICAgICAgIHRoaXMuZW5hYmxlU2Nyb2xsWm9vbSA9IEJvb2xlYW4oZW5hYmxlKTtcbiAgICB9XG5cbiAgICBASW5wdXQoKSBhbHRUZXh0ID0gJyc7XG4gICAgQElucHV0KCkgdGl0bGVUZXh0ID0gJyc7XG5cbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcbiAgICAgICAgLy8gSWYgbm8gZnVsbCBzaXplIGltYWdlIGlzIGRlZmluZWQsIHdlIGFkZCB0aGUgdGh1bWJuYWlsIGFzIHRoZSBmdWxsIHNpemUgdG9vLlxuICAgICAgICBpZiAodGhpcy5mdWxsSW1hZ2UgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5mdWxsSW1hZ2UgPSB0aGlzLnRodW1iSW1hZ2U7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnJlZ2lzdGVyU2VydmljZVN1YnNjcmlwdGlvbnMoKTtcblxuICAgICAgICAvLyBMb2FkIHpvb20gbW9kZSBhbmQgc2V0IHVwIGNvbmZpZ3VyYXRpb24uXG4gICAgICAgIHRoaXMubG9hZFpvb21Nb2RlKCk7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudExpc3RlbmVycygpO1xuICAgICAgICB0aGlzLmNhbGN1bGF0ZUxlbnNCb3JkZXIoKTtcbiAgICB9XG5cbiAgICBuZ09uQ2hhbmdlcygpIHtcbiAgICAgICAgdGhpcy5jYWxjdWxhdGVMZW5zQm9yZGVyKCk7XG4gICAgICAgIHRoaXMuem9vbVNlcnZpY2UuY2FsY3VsYXRlUmF0aW9BbmRPZmZzZXQoKTtcbiAgICAgICAgdGhpcy56b29tU2VydmljZS5jYWxjdWxhdGVJbWFnZUFuZExlbnNQb3NpdGlvbigpO1xuICAgIH1cblxuICAgIG5nT25EZXN0cm95KCk6IHZvaWQge1xuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMuZm9yRWFjaCgoc3Vic2NyaXB0aW9uKSA9PiBzdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKSk7XG4gICAgICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnMuZm9yRWFjaCgoZGVzdHJveUZuKSA9PiBkZXN0cm95Rm4oKSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZWdpc3RlclNlcnZpY2VTdWJzY3JpcHRpb25zKCkge1xuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaChcbiAgICAgICAgICAgIHRoaXMuem9vbVNlcnZpY2Uuem9vbVBvc2l0aW9uLnN1YnNjcmliZSgocG9zaXRpb24pID0+IHRoaXMuem9vbVBvc2l0aW9uLmVtaXQocG9zaXRpb24pKVxuICAgICAgICApO1xuICAgIH1cblxuICAgIHByaXZhdGUgbG9hZFpvb21Nb2RlKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBab29tTW9kZUNsYXNzID0gdGhpcy56b29tTW9kZXNNYXAuZ2V0KHRoaXMuem9vbU1vZGUpO1xuICAgICAgICBpZiAoWm9vbU1vZGVDbGFzcykge1xuICAgICAgICAgICAgdGhpcy56b29tSW5zdGFuY2UgPSBuZXcgWm9vbU1vZGVDbGFzcyh0aGlzLnpvb21TZXJ2aWNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFVuc3VwcG9ydGVkIHpvb20gbW9kZTogJHt0aGlzLnpvb21Nb2RlfWApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZWdpc3RlckV2ZW50TGlzdGVuZXJzKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy56b29tSW5zdGFuY2UpIHtcbiAgICAgICAgICAgIGNvbnN0IG5hdGl2ZUVsZW1lbnQgPSB0aGlzLnpvb21Db250YWluZXIubmF0aXZlRWxlbWVudDtcblxuICAgICAgICAgICAgdGhpcy5ldmVudExpc3RlbmVycy5wdXNoKFxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIubGlzdGVuKG5hdGl2ZUVsZW1lbnQsICdtb3VzZWVudGVyJywgKGV2ZW50KSA9PiB0aGlzLnpvb21JbnN0YW5jZS5vbk1vdXNlRW50ZXIoZXZlbnQpKSxcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmxpc3RlbihuYXRpdmVFbGVtZW50LCAnbW91c2VsZWF2ZScsIChldmVudCkgPT4gdGhpcy56b29tSW5zdGFuY2Uub25Nb3VzZUxlYXZlKGV2ZW50KSksXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5saXN0ZW4obmF0aXZlRWxlbWVudCwgJ21vdXNlbW92ZScsIChldmVudCkgPT4gdGhpcy56b29tSW5zdGFuY2Uub25Nb3VzZU1vdmUoZXZlbnQpKSxcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmxpc3RlbihuYXRpdmVFbGVtZW50LCAnY2xpY2snLCAoZXZlbnQpID0+IHRoaXMuem9vbUluc3RhbmNlLm9uQ2xpY2soZXZlbnQpKSxcblxuICAgICAgICAgICAgICAgIC8vIENocm9tZTogJ21vdXNld2hlZWwnLCBGaXJlZm94OiAnRE9NTW91c2VTY3JvbGwnLCBJRTogJ29ubW91c2V3aGVlbCdcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmxpc3RlbihuYXRpdmVFbGVtZW50LCAnbW91c2V3aGVlbCcsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy56b29tSW5zdGFuY2Uub25Nb3VzZVdoZWVsKGV2ZW50KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbk1vdXNlV2hlZWwoZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5saXN0ZW4obmF0aXZlRWxlbWVudCwgJ0RPTU1vdXNlU2Nyb2xsJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnpvb21JbnN0YW5jZS5vbk1vdXNlV2hlZWwoZXZlbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uTW91c2VXaGVlbChldmVudCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmxpc3RlbihuYXRpdmVFbGVtZW50LCAnb25tb3VzZXdoZWVsJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnpvb21JbnN0YW5jZS5vbk1vdXNlV2hlZWwoZXZlbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uTW91c2VXaGVlbChldmVudCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRlbXBsYXRlIGhlbHBlciBtZXRob2RzXG4gICAgICovXG4gICAgb25UaHVtYkltYWdlTG9hZGVkKCkge1xuICAgICAgICAvLyBQYXNzIGFsb25nIGltYWdlIHNpemVzIHRvIHRoZSBzZXJ2aWNlLlxuICAgICAgICB0aGlzLnpvb21TZXJ2aWNlLnRodW1iV2lkdGggPSB0aGlzLmltYWdlVGh1bWJuYWlsLm5hdGl2ZUVsZW1lbnQud2lkdGg7XG4gICAgICAgIHRoaXMuem9vbVNlcnZpY2UudGh1bWJIZWlnaHQgPSB0aGlzLmltYWdlVGh1bWJuYWlsLm5hdGl2ZUVsZW1lbnQuaGVpZ2h0O1xuICAgICAgICB0aGlzLnRodW1iSW1hZ2VMb2FkZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmNoZWNrSW1hZ2VzTG9hZGVkKCk7XG4gICAgfVxuXG4gICAgb25GdWxsSW1hZ2VMb2FkZWQoKSB7XG4gICAgICAgIC8vIFBhc3MgYWxvbmcgaW1hZ2Ugc2l6ZXMgdG8gdGhlIHNlcnZpY2UuXG4gICAgICAgIHRoaXMuem9vbVNlcnZpY2UuZnVsbFdpZHRoID0gdGhpcy5mdWxsU2l6ZUltYWdlLm5hdGl2ZUVsZW1lbnQubmF0dXJhbFdpZHRoO1xuICAgICAgICB0aGlzLnpvb21TZXJ2aWNlLmZ1bGxIZWlnaHQgPSB0aGlzLmZ1bGxTaXplSW1hZ2UubmF0aXZlRWxlbWVudC5uYXR1cmFsSGVpZ2h0O1xuICAgICAgICB0aGlzLnpvb21TZXJ2aWNlLmZ1bGxJbWFnZUxvYWRlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuY2hlY2tJbWFnZXNMb2FkZWQoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNhbGN1bGF0ZUxlbnNCb3JkZXIoKSB7XG4gICAgICAgIGlmICh0aGlzLnpvb21TZXJ2aWNlLmVuYWJsZUxlbnMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNpcmN1bGFyTGVucykge1xuICAgICAgICAgICAgICAgIHRoaXMubGVuc0JvcmRlclJhZGl1cyA9IHRoaXMuem9vbVNlcnZpY2UubGVuc1dpZHRoIC8gMjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sZW5zQm9yZGVyUmFkaXVzID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgY2hlY2tJbWFnZXNMb2FkZWQoKSB7XG4gICAgICAgIHRoaXMuem9vbVNlcnZpY2UuY2FsY3VsYXRlUmF0aW9BbmRPZmZzZXQoKTtcbiAgICAgICAgaWYgKHRoaXMudGh1bWJJbWFnZUxvYWRlZCAmJiB0aGlzLnpvb21TZXJ2aWNlLmZ1bGxJbWFnZUxvYWRlZCkge1xuICAgICAgICAgICAgdGhpcy56b29tU2VydmljZS5jYWxjdWxhdGVJbWFnZUFuZExlbnNQb3NpdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5zZXRJc1JlYWR5KHRydWUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZXRJc1JlYWR5KHZhbHVlOiBib29sZWFuKSB7XG4gICAgICAgIHRoaXMuem9vbVNlcnZpY2UuaXNSZWFkeSA9IHZhbHVlO1xuICAgICAgICB0aGlzLmltYWdlc0xvYWRlZC5lbWl0KHZhbHVlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNb3VzZSB3aGVlbCBldmVudFxuICAgICAqL1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgcHJpdmF0ZSBvbk1vdXNlV2hlZWwoZXZlbnQ6IGFueSkge1xuICAgICAgICAvLyBEb24ndCBlYXQgZXZlbnRzIGlmIHNjcm9sbFpvb20gb3Igem9vbWluZyBpc24ndCBhY3RpdmVcbiAgICAgICAgaWYgKCF0aGlzLmVuYWJsZVNjcm9sbFpvb20gfHwgIXRoaXMuem9vbVNlcnZpY2Uuem9vbWluZ0VuYWJsZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGV2ZW50ID0gd2luZG93LmV2ZW50IHx8IGV2ZW50OyAvLyBvbGQgSUVcbiAgICAgICAgY29uc3QgZGlyZWN0aW9uID0gTWF0aC5tYXgoTWF0aC5taW4oZXZlbnQud2hlZWxEZWx0YSB8fCAtZXZlbnQuZGV0YWlsLCAxKSwgLTEpO1xuICAgICAgICBpZiAoZGlyZWN0aW9uID4gMCkge1xuICAgICAgICAgICAgLy8gdXBcbiAgICAgICAgICAgIHRoaXMuc2V0TWFnbmlmaWNhdGlvbiA9IE1hdGgubWluKFxuICAgICAgICAgICAgICAgIHRoaXMuem9vbVNlcnZpY2UubWFnbmlmaWNhdGlvbiArIHRoaXMuc2Nyb2xsU3RlcFNpemUsXG4gICAgICAgICAgICAgICAgdGhpcy56b29tU2VydmljZS5tYXhab29tUmF0aW9cbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBkb3duXG4gICAgICAgICAgICB0aGlzLnNldE1hZ25pZmljYXRpb24gPSBNYXRoLm1heChcbiAgICAgICAgICAgICAgICB0aGlzLnpvb21TZXJ2aWNlLm1hZ25pZmljYXRpb24gLSB0aGlzLnNjcm9sbFN0ZXBTaXplLFxuICAgICAgICAgICAgICAgIHRoaXMuem9vbVNlcnZpY2UubWluWm9vbVJhdGlvXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuem9vbVNlcnZpY2UuY2FsY3VsYXRlUmF0aW8oKTtcbiAgICAgICAgdGhpcy56b29tU2VydmljZS5jYWxjdWxhdGVab29tUG9zaXRpb24oZXZlbnQpO1xuXG4gICAgICAgIC8vIFByZXZlbnQgc2Nyb2xsaW5nIG9uIHBhZ2UuXG4gICAgICAgIGV2ZW50LnJldHVyblZhbHVlID0gZmFsc2U7IC8vIElFXG4gICAgICAgIGlmIChldmVudC5wcmV2ZW50RGVmYXVsdCkge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsgLy8gQ2hyb21lICYgRkZcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsIjxkaXZcbiAgICAjem9vbUNvbnRhaW5lclxuICAgIGNsYXNzPVwibmd4SW1hZ2Vab29tQ29udGFpbmVyXCJcbiAgICBbc3R5bGUud2lkdGgucHhdPVwidGhpcy56b29tU2VydmljZS50aHVtYldpZHRoXCJcbiAgICBbc3R5bGUuaGVpZ2h0LnB4XT1cInRoaXMuem9vbVNlcnZpY2UudGh1bWJIZWlnaHRcIlxuPlxuICAgIDxpbWdcbiAgICAgICAgI2ltYWdlVGh1bWJuYWlsXG4gICAgICAgIGNsYXNzPVwibmd4SW1hZ2Vab29tVGh1bWJuYWlsXCJcbiAgICAgICAgW2FsdF09XCJhbHRUZXh0XCJcbiAgICAgICAgW3RpdGxlXT1cInRpdGxlVGV4dFwiXG4gICAgICAgIFtzcmNdPVwidGh1bWJJbWFnZVwiXG4gICAgICAgIChsb2FkKT1cIm9uVGh1bWJJbWFnZUxvYWRlZCgpXCJcbiAgICAvPlxuXG4gICAgPGRpdlxuICAgICAgICBbbmdDbGFzc109XCJ7XG4gICAgICAgICAgICBuZ3hJbWFnZVpvb21GdWxsQ29udGFpbmVyOiB0cnVlLFxuICAgICAgICAgICAgbmd4SW1hZ2Vab29tTGVuc0VuYWJsZWQ6IHRoaXMuem9vbVNlcnZpY2UuZW5hYmxlTGVuc1xuICAgICAgICB9XCJcbiAgICAgICAgW3N0eWxlLmRpc3BsYXldPVwidGhpcy56b29tU2VydmljZS56b29tRGlzcGxheVwiXG4gICAgICAgIFtzdHlsZS50b3AucHhdPVwidGhpcy56b29tU2VydmljZS5sZW5zVG9wXCJcbiAgICAgICAgW3N0eWxlLmxlZnQucHhdPVwidGhpcy56b29tU2VydmljZS5sZW5zTGVmdFwiXG4gICAgICAgIFtzdHlsZS53aWR0aC5weF09XCJ0aGlzLnpvb21TZXJ2aWNlLmxlbnNXaWR0aFwiXG4gICAgICAgIFtzdHlsZS5oZWlnaHQucHhdPVwidGhpcy56b29tU2VydmljZS5sZW5zSGVpZ2h0XCJcbiAgICAgICAgW3N0eWxlLmJvcmRlci1yYWRpdXMucHhdPVwidGhpcy5sZW5zQm9yZGVyUmFkaXVzXCJcbiAgICA+XG4gICAgICAgIDxpbWdcbiAgICAgICAgICAgICNmdWxsU2l6ZUltYWdlXG4gICAgICAgICAgICBjbGFzcz1cIm5neEltYWdlWm9vbUZ1bGxcIlxuICAgICAgICAgICAgW2FsdF09XCJhbHRUZXh0XCJcbiAgICAgICAgICAgIFt0aXRsZV09XCJ0aXRsZVRleHRcIlxuICAgICAgICAgICAgW3NyY109XCJmdWxsSW1hZ2VcIlxuICAgICAgICAgICAgKGxvYWQpPVwib25GdWxsSW1hZ2VMb2FkZWQoKVwiXG4gICAgICAgICAgICBbc3R5bGUuZGlzcGxheV09XCJ0aGlzLnpvb21TZXJ2aWNlLnpvb21EaXNwbGF5XCJcbiAgICAgICAgICAgIFtzdHlsZS50b3AucHhdPVwidGhpcy56b29tU2VydmljZS5mdWxsSW1hZ2VUb3BcIlxuICAgICAgICAgICAgW3N0eWxlLmxlZnQucHhdPVwidGhpcy56b29tU2VydmljZS5mdWxsSW1hZ2VMZWZ0XCJcbiAgICAgICAgICAgIFtzdHlsZS53aWR0aC5weF09XCJ0aGlzLnpvb21TZXJ2aWNlLm1hZ25pZmllZFdpZHRoXCJcbiAgICAgICAgICAgIFtzdHlsZS5oZWlnaHQucHhdPVwidGhpcy56b29tU2VydmljZS5tYWduaWZpZWRIZWlnaHRcIlxuICAgICAgICAvPlxuICAgIDwvZGl2PlxuPC9kaXY+XG4iXX0=